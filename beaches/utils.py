from . import models
import random
from datetime import date
from .models import Task
from collections import OrderedDict

def check_badges(profile):
    unlocked = []

    if profile.tasks_completed >= 10:
        unlocked.append('Explorer')
    if profile.xp >= 1000:
        unlocked.append('Achiever')

    for title in unlocked:
        badge = models.Badge.objects.filter(title=title).first()
        if badge and not profile.badge_set.filter(id=badge.id).exists():
            profile.badge_set.add(badge)
            
def generate_daily_tasks():
    print("üåÄ Running daily task generator...")

    ICON_MAP = {
        "–í—ä–ª–Ω–∞": "bi-water",
        "–ú–∏–¥–∞": "bi-egg-fried",
        "–†–∞–ø–∞–Ω": "bi-egg-fried",
        "–ú–æ—Ä—Å–∫–∞ –ø—è–Ω–∞": "bi-droplet",
        "–û–±–ª–∞–∫": "bi-cloud",
        "–ú–æ—Ä—Å–∫–∞ —Ç—Ä–µ–≤–∞": "bi-tree",
        "–ß–∏—Å—Ç –ø—è—Å—ä–∫": "bi-brush",
        "–ü–ª–∞—Å—Ç–º–∞—Å–æ–≤–∞ –±—É—Ç–∏–ª–∫–∞": "bi-bottle",
        "–ö–∞–ø–∞—á–∫–∞": "bi-circle",
        "–î—ä—Ä–≤–æ": "bi-tree",
        "–°–ª–µ–¥–∏ –≤ –ø—è—Å—ä–∫–∞": "bi-footprint",
        "–ö–∞–º—ä–∫": "bi-square",
        "–ß–µ—Ä—É–ø–∫–∞ –æ—Ç –º–∏–¥–∞": "bi-egg",
        "–õ–∏–Ω–∏—è—Ç–∞ –Ω–∞ –ø—Ä–∏–ª–∏–≤–∞": "bi-water",
        "–ü–ª–∞–∂–µ–Ω –æ—Ç–ø–∞–¥—ä–∫": "bi-trash",
        "–¢—ä–º–µ–Ω –æ–±–ª–∞–∫": "bi-clouds",
        "–°–≤–µ—Ç—ä–ª –æ–±–ª–∞–∫": "bi-cloud-sun",
        "–í–æ–¥–æ—Ä–∞—Å–ª–∏": "bi-tree",
        "–ì–æ–ª—è–º–∞ –≤–æ–¥–æ—Ä–∞—Å–ª–æ–≤–∞ –∫—É–ø—á–∏–Ω–∞": "bi-tree-fill",
        "–ü—è—Å—ä—á–Ω–∞ —Ñ–æ—Ä–º–∞—Ü–∏—è": "bi-square",
        "–ö–∞–º—ä–∫ —Å —Ñ–æ—Ä–º–∞": "bi-circle",
        "–ú–æ—Ä—Å–∫–∏ –ø—Ä–µ–¥–º–µ—Ç –æ—Ç –¥—ä—Ä–≤–æ": "bi-tree",
        "–°–ª—ä–Ω—Ü–µ –∏ –≤–æ–¥–∞": "bi-sun",
        "–§–∞—Ä": "bi-lighthouse",
        "–ö–µ–π –∏–ª–∏ –ø—Ä–∏—Å—Ç–∞–Ω": "bi-box-seam",
        "–û—Ç–¥–∞–ª–µ—á–µ–Ω –ø–ª–∞–∂": "bi-geo-alt",
        "–ì–æ–ª—è–º–∞ –≤—ä–ª–Ω–∞": "bi-water",
        "–°–∫–∞–ª–Ω–∞ —Ñ–æ—Ä–º–∞—Ü–∏—è": "bi-geo",
        "–ú–æ—Ä—Å–∫–∞ –ø–µ—â–µ—Ä–∞": "bi-geo-alt-fill",
    }

    TASK_POOL = [
        # EASY
        ("–í—ä–ª–Ω–∞", "–û—Ç–∏–¥–∏ –¥–æ –±—Ä–µ–≥–∞ –∏ –∑–∞—Å–Ω–µ–º–∏ –º–æ—Ä—Å–∫–∞ –≤—ä–ª–Ω–∞, –∫–∞—Ç–æ —Å–µ –æ–ø–∏—Ç–∞—à –¥–∞ —É–ª–æ–≤–∏—à —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –¥–≤–∏–∂–µ–Ω–∏–µ—Ç–æ —ù.", "sea wave"),
        ("–ú–∏–¥–∞", "–ù–∞–º–µ—Ä–∏ –º–∏–¥–∞ –Ω–∞ –ø–ª–∞–∂–∞ –∏ —è –∑–∞—Å–Ω–µ–º–∏ —Ç–∞–∫–∞, —á–µ –¥–∞ —Å–µ –≤–∏–∂–¥–∞—Ç –¥–µ—Ç–∞–π–ª–∏—Ç–µ –Ω–∞ —á–µ—Ä—É–ø–∫–∞—Ç–∞.", "beach shell"),
        ("–†–∞–ø–∞–Ω", "–û—Ç–∫—Ä–∏–π —Ä–∞–ø–∞–Ω –∏ –Ω–∞–ø—Ä–∞–≤–∏ —Å–Ω–∏–º–∫–∞, –ø–æ–∫–∞–∑–≤–∞—â–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –º—É.", "rapana shell"),
        ("–ú–æ—Ä—Å–∫–∞ –ø—è–Ω–∞", "–ó–∞—Å–Ω–µ–º–∏ –∑–æ–Ω–∞ —Å –º–æ—Ä—Å–∫–∞ –ø—è–Ω–∞ –Ω–∞ –±—Ä–µ–≥–∞, –ø–æ–∫–∞–∑–≤–∞–π–∫–∏ —Ç–µ–∫—Å—Ç—É—Ä–∞—Ç–∞ –∏ –¥–≤–∏–∂–µ–Ω–∏–µ—Ç–æ.", "sea foam"),
        ("–û–±–ª–∞–∫", "–°–Ω–∏–º–∞–π –æ–±–ª–∞–∫ –Ω–∞–¥ –º–æ—Ä–µ—Ç–æ, –∫–∞—Ç–æ –ø–æ–∫–∞–∂–µ—à —Ñ–æ—Ä–º–∞—Ç–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞ –º—É.", "cloud over sea"),
        ("–ú–æ—Ä—Å–∫–∞ —Ç—Ä–µ–≤–∞", "–ó–∞—Å–Ω–µ–º–∏ –∏–∑—Ö–≤—ä—Ä–ª–µ–Ω–∞ –º–æ—Ä—Å–∫–∞ —Ç—Ä–µ–≤–∞ –Ω–∞ –±—Ä–µ–≥–∞, –ø–æ–∫–∞–∑–≤–∞–π–∫–∏ —Ü–≤–µ—Ç–∞ –∏ —Ç–µ–∫—Å—Ç—É—Ä–∞—Ç–∞.", "seaweed"),
        ("–ß–∏—Å—Ç –ø—è—Å—ä–∫", "–ü–æ–∫–∞–∂–∏ —á–∏—Å—Ç —É—á–∞—Å—Ç—ä–∫ –æ—Ç –ø–ª–∞–∂–∞ –∏ —Ç–µ–∫—Å—Ç—É—Ä–∞—Ç–∞ –Ω–∞ –ø—è—Å—ä–∫–∞.", "clean sand"),
        ("–ü–ª–∞—Å—Ç–º–∞—Å–æ–≤–∞ –±—É—Ç–∏–ª–∫–∞", "–ù–∞–º–µ—Ä–∏ –∏ –∑–∞—Å–Ω–µ–º–∏ –ø–ª–∞—Å—Ç–º–∞—Å–æ–≤–∞ –±—É—Ç–∏–ª–∫–∞ –Ω–∞ –±—Ä–µ–≥–∞.", "plastic bottle"),
        ("–ö–∞–ø–∞—á–∫–∞", "–°–Ω–∏–º–∞–π –ø–ª–∞—Å—Ç–º–∞—Å–æ–≤–∞ –∫–∞–ø–∞—á–∫–∞, –Ω–∞–º–µ—Ä–µ–Ω–∞ –Ω–∞ –ø–ª–∞–∂–∞.", "bottle cap"),
        ("–î—ä—Ä–≤–æ", "–ó–∞—Å–Ω–µ–º–∏ –ø–∞—Ä—á–µ –¥—ä—Ä–≤–æ –∏–ª–∏ –∫–æ—Ä–µ–Ω –Ω–∞ –ø–ª–∞–∂–∞.", "driftwood piece"),
        ("–°–ª–µ–¥–∏ –≤ –ø—è—Å—ä–∫–∞", "–ü–æ–∫–∞–∂–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∏ —Å–ª–µ–¥–∏ –ø–æ –ø—è—Å—ä–∫–∞.", "sand tracks"),
        ("–ö–∞–º—ä–∫", "–ù–∞–º–µ—Ä–∏ –∏ –∑–∞—Å–Ω–µ–º–∏ –∫–∞–º—ä–∫ –Ω–∞ –±—Ä–µ–≥–∞.", "stone"),
        ("–ß–µ—Ä—É–ø–∫–∞ –æ—Ç –º–∏–¥–∞", "–û—Ç–∫—Ä–∏–π –∏ –∑–∞—Å–Ω–µ–º–∏ –º–∏–¥–µ–Ω–∞ —á–µ—Ä—É–ø–∫–∞.", "shell"),
        ("–õ–∏–Ω–∏—è—Ç–∞ –Ω–∞ –ø—Ä–∏–ª–∏–≤–∞", "–°–Ω–∏–º–∞–π –º–æ–∫—Ä–∏—è –ø—è—Å—ä–∫ –¥–æ –≤–æ–¥–∞—Ç–∞, –ø–æ–∫–∞–∑–≤–∞–π–∫–∏ –ª–∏–Ω–∏—è—Ç–∞ –Ω–∞ –ø—Ä–∏–ª–∏–≤–∞.", "tideline"),
        ("–ü–ª–∞–∂–µ–Ω –æ—Ç–ø–∞–¥—ä–∫", "–ó–∞—Å–Ω–µ–º–∏ –º–∞–ª—ä–∫ –æ—Ç–ø–∞–¥—ä–∫ –Ω–∞ –ø–ª–∞–∂–∞.", "small litter"),
        ("–¢—ä–º–µ–Ω –æ–±–ª–∞–∫", "–°–Ω–∏–º–∞–π —Ç—ä–º–µ–Ω –æ–±–ª–∞–∫ –Ω–∞–¥ –º–æ—Ä–µ—Ç–æ.", "dark cloud"),
        ("–°–≤–µ—Ç—ä–ª –æ–±–ª–∞–∫", "–ó–∞—Å–Ω–µ–º–∏ —Å–≤–µ—Ç—ä–ª –∏–ª–∏ –ø—É—Ö–∫–∞–≤ –æ–±–ª–∞–∫.", "light cloud"),
        ("–í–æ–¥–æ—Ä–∞—Å–ª–∏", "–°–Ω–∏–º–∞–π –∏–∑—Ö–≤—ä—Ä–ª–µ–Ω–∏ –≤–æ–¥–æ—Ä–∞—Å–ª–∏ –Ω–∞ –±—Ä–µ–≥–∞.", "seaweed clump"),

        # MEDIUM
        ("–ì–æ–ª—è–º–∞ –≤–æ–¥–æ—Ä–∞—Å–ª–æ–≤–∞ –∫—É–ø—á–∏–Ω–∞", "–ó–∞—Å–Ω–µ–º–∏ –≥–æ–ª—è–º–∞ –∫—É–ø—á–∏–Ω–∞ –≤–æ–¥–æ—Ä–∞—Å–ª–∏ –Ω–∞ –ø–ª–∞–∂–∞, –ø–æ–∫–∞–∑–≤–∞–π–∫–∏ —Ä–∞–∑–ª–∏—á–Ω–∏—Ç–µ –≤–∏–¥–æ–≤–µ –∏ —Ç–µ–∫—Å—Ç—É—Ä–∏.", "large seaweed pile"),
        ("–ü—è—Å—ä—á–Ω–∞ —Ñ–æ—Ä–º–∞—Ü–∏—è", "–°–Ω–∏–º–∞–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –ø—è—Å—ä—á–Ω–∞ —Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–∞—Ç–æ –º–∞–ª–∫–∏ –¥—é–Ω–∏ –∏–ª–∏ –∫–∞–Ω–∞–ª–∏ –æ—Ç –≤–æ–¥–∞.", "sand formation"),
        ("–ö–∞–º—ä–∫ —Å —Ñ–æ—Ä–º–∞", "–ù–∞–º–µ—Ä–∏ –∫–∞–º—ä–∫ —Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ —Ñ–æ—Ä–º–∞ –∏ –≥–æ –∑–∞—Å–Ω–µ–º–∏ –æ—Ç–±–ª–∏–∑–æ.", "shaped stone"),
        ("–ú–æ—Ä—Å–∫–∏ –ø—Ä–µ–¥–º–µ—Ç –æ—Ç –¥—ä—Ä–≤–æ", "–ó–∞—Å–Ω–µ–º–∏ –¥—ä—Ä–≤–µ–Ω –ø—Ä–µ–¥–º–µ—Ç, –∏–∑—Ö–≤—ä—Ä–ª–µ–Ω –æ—Ç –º–æ—Ä–µ—Ç–æ, –ø–æ–∫–∞–∑–≤–∞–π–∫–∏ —Ç–µ–∫—Å—Ç—É—Ä–∞—Ç–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∞.", "driftwood object"),
        ("–°–ª—ä–Ω—Ü–µ –∏ –≤–æ–¥–∞", "–°–Ω–∏–º–∞–π –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ—Ç–æ –Ω–∞ —Å–ª—ä–Ω—Ü–µ—Ç–æ –≤—ä–≤ –≤–æ–¥–∞—Ç–∞.", "sun reflection on water"),
        ("–ü–µ—Ç —Ä–∞–∑–ª–∏—á–Ω–∏ –æ—Ç–ø–∞–¥—ä–∫–∞", "–û—Ç–∫—Ä–∏–π –∏ —Å—ä–±–µ—Ä–∏ –ø–µ—Ç —Ä–∞–∑–ª–∏—á–Ω–∏ –æ—Ç–ø–∞–¥—ä–∫–∞ –Ω–∞ –ø–ª–∞–∂–∞.", "five litter items"),
        ("–î—ä—Ä–≤–æ –æ—Ç –º–æ—Ä–µ—Ç–æ", "–°–Ω–∏–º–∞–π –≥–æ–ª—è–º–æ –ø–∞—Ä—á–µ –¥—ä—Ä–≤–æ, –∏–∑—Ö–≤—ä—Ä–ª–µ–Ω–æ –æ—Ç –º–æ—Ä–µ—Ç–æ.", "large driftwood"),
        ("–ü–ª–∞–∂–Ω–∞ —Ç–∞–±–µ–ª–∞", "–ó–∞—Å–Ω–µ–º–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞ —Ç–∞–±–µ–ª–∞ –Ω–∞ –ø–ª–∞–∂–∞.", "beach sign"),
        ("–°–∏–ª–Ω–æ –≤—ä–ª–Ω–µ–Ω–∏–µ", "–£–ª–æ–≤–∏ –±—É—Ä–Ω–∏ –≤—ä–ª–Ω–∏ –∏–ª–∏ —Ä–∞–∑–ø–µ–Ω–µ–Ω–∞ –≤–æ–¥–∞.", "rough sea"),
        ("–ö–∞–º–µ–Ω–Ω–∞ –≥—Ä—É–ø–∞", "–ó–∞—Å–Ω–µ–º–∏ –≥—Ä—É–ø–∞ –æ—Ç –∫–∞–º—ä–Ω–∏ —Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∏ —Ñ–æ—Ä–º–∏.", "stone cluster"),

        # HARD
        ("–§–∞—Ä", "–ù–∞–º–µ—Ä–∏ –∏ –∑–∞—Å–Ω–µ–º–∏ —Ñ–∞—Ä –∏–ª–∏ –º–∞—è–∫, –ø–æ–∫–∞–∑–≤–∞–π–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞ –∏ –æ–∫–æ–ª–Ω–∞—Ç–∞ —Å—Ä–µ–¥–∞.", "lighthouse"),
        ("–ö–µ–π –∏–ª–∏ –ø—Ä–∏—Å—Ç–∞–Ω", "–°–Ω–∏–º–∞–π –º–æ—Å—Ç, –∫–µ–π –∏–ª–∏ –ø—Ä–∏—Å—Ç–∞–Ω, –∫–∞—Ç–æ –ø–æ–∫–∞–∂–µ—à –¥–µ—Ç–∞–π–ª–∏—Ç–µ –º—É.", "pier"),
        ("–û—Ç–¥–∞–ª–µ—á–µ–Ω –ø–ª–∞–∂", "–°–Ω–∏–º–∞–π –∏–∑–æ–ª–∏—Ä–∞–Ω –ø–ª–∞–∂–µ–Ω —É—á–∞—Å—Ç—ä–∫ —Å –∞–∫—Ü–µ–Ω—Ç –≤—ä—Ä—Ö—É —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–∞ –±—Ä–µ–≥–∞.", "remote beach"),
        ("–ì–æ–ª—è–º–∞ –∫—É–ø—á–∏–Ω–∞ –±–æ–∫–ª—É–∫", "–ó–∞—Å–Ω–µ–º–∏ —Å–∏–ª–Ω–æ –∑–∞–º—ä—Ä—Å–µ–Ω–∞ –∑–æ–Ω–∞ –Ω–∞ –ø–ª–∞–∂–∞.", "large litter pile"),
        ("–ì–æ–ª—è–º–∞ –≤—ä–ª–Ω–∞", "–°–Ω–∏–º–∞–π –≤–∏—Å–æ–∫–∞ –∏–ª–∏ —Ä–∞–∑–±–∏–≤–∞—â–∞ —Å–µ –≤—ä–ª–Ω–∞.", "large wave"),
        ("–°–∫–∞–ª–Ω–∞ —Ñ–æ—Ä–º–∞—Ü–∏—è", "–ó–∞—Å–Ω–µ–º–∏ —Å–∫–∞–ª–∏—Å—Ç —É—á–∞—Å—Ç—ä–∫ –¥–æ –º–æ—Ä–µ—Ç–æ.", "rock formation"),
        ("–ï—Ä–æ–∑–∏—è –Ω–∞ –±—Ä–µ–≥–∞", "–°–Ω–∏–º–∞–π —Å–ª–µ–¥–∏ –æ—Ç –µ—Ä–æ–∑–∏—è –∏–ª–∏ —Å–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –±—Ä–µ–≥–∞.", "coastal erosion"),
        ("–ú–æ—Ä—Å–∫–∏ –±—É–π", "–ó–∞—Å–Ω–µ–º–∏ –±—É–π –≤ –º–æ—Ä–µ—Ç–æ –∏–ª–∏ –∫—Ä–∞–π –±—Ä–µ–≥–∞.", "sea buoy"),
        ("–§–∞—Ä –ø—Ä–∏ –∑–∞–ª–µ–∑", "–°–Ω–∏–º–∞–π —Ñ–∞—Ä –≤ —Å–≤–µ—Ç–ª–∏–Ω–∞—Ç–∞ –Ω–∞ –∑–∞–ª–µ–∑–∞.", "lighthouse at sunset"),
        ("–ú–æ—Ä—Å–∫–∞ –ø–µ—â–µ—Ä–∞", "–ê–∫–æ –∏–º–∞, –∑–∞—Å–Ω–µ–º–∏ –º–æ—Ä—Å–∫–∞ –Ω–∏—à–∞ –∏–ª–∏ –ø–µ—â–µ—Ä–∞.", "sea cave"),
    ]

    Task.objects.filter(is_daily=True).delete()

    daily_tasks = []
    for i in range(5):
        title, user_desc, description = random.choice(TASK_POOL)
        difficulty = random.choice(["easy", "medium", "hard"])
        icon = ICON_MAP.get(title, "bi-star")
        task = Task.objects.create(
            title=title,
            user_desc=user_desc,
            description=description,
            difficulty=difficulty,
            date_assigned=date.today(),
            is_daily=True,
            icon = icon
        )
        daily_tasks.append(task)

    users = models.UserProfile.objects.all()
    for user in users:
        for task in daily_tasks:
            user.tasks.add(task)

    print(f"‚úÖ {len(daily_tasks)} new daily tasks created and assigned to {len(users)} users.")
    return daily_tasks

WEATHER_MAP = {
    0: ("–Ø—Å–Ω–æ", "bi-sun-fill"),
    1: ("–ü—Ä–µ–¥–∏–º–Ω–æ —è—Å–Ω–æ", "bi-sun"),
    2: ("–ü—Ä–µ–æ–±–ª–∞–¥–∞–≤–∞—â–æ –æ–±–ª–∞—á–Ω–æ", "bi-cloud-sun"),
    3: ("–û–±–ª–∞—á–Ω–æ", "bi-cloud"),
    45: ("–ú—ä–≥–ª–∞", "bi-cloud-fog"),
    48: ("–ú—ä–≥–ª–∞ —Å –ª–µ–¥–µ–Ω–∏ –∫—Ä–∏—Å—Ç–∞–ª–∏", "bi-cloud-fog"),
    51: ("–°–ª–∞–± –¥—ä–∂–¥ (–∫–∞–ø–∫–∏)", "bi-cloud-drizzle"),
    53: ("–£–º–µ—Ä–µ–Ω –¥—ä–∂–¥ (–∫–∞–ø–∫–∏)", "bi-cloud-drizzle"),
    55: ("–°–∏–ª–µ–Ω –¥—ä–∂–¥ (–∫–∞–ø–∫–∏)", "bi-cloud-drizzle"),
    56: ("–õ–µ–¥–µ–Ω —Å–ª–∞–± –¥—ä–∂–¥", "bi-cloud-drizzle"),
    57: ("–õ–µ–¥–µ–Ω —Å–∏–ª–µ–Ω –¥—ä–∂–¥", "bi-cloud-drizzle"),
    61: ("–°–ª–∞–± –¥—ä–∂–¥", "bi-cloud-rain"),
    63: ("–£–º–µ—Ä–µ–Ω –¥—ä–∂–¥", "bi-cloud-rain"),
    65: ("–°–∏–ª–µ–Ω –¥—ä–∂–¥", "bi-cloud-rain"),
    66: ("–°–ª–∞–± –ª–µ–¥–µ–Ω–æ —Å—Ç—É–¥–µ–Ω –¥—ä–∂–¥", "bi-cloud-rain"),
    67: ("–°–∏–ª–µ–Ω –ª–µ–¥–µ–Ω–æ —Å—Ç—É–¥–µ–Ω –¥—ä–∂–¥", "bi-cloud-rain"),
    71: ("–°–ª–∞–± —Å–Ω—è–≥", "bi-snow"),
    73: ("–£–º–µ—Ä–µ–Ω —Å–Ω—è–≥", "bi-snow"),
    75: ("–°–∏–ª–µ–Ω —Å–Ω—è–≥", "bi-snow"),
    77: ("–°–Ω—è–≥ –Ω–∞ —Å–∏—Ç–Ω–∏ —á–∞—Å—Ç–∏—Ü–∏", "bi-snow"),
    80: ("–ü—Ä–æ–ª–∏–≤–µ–Ω –¥—ä–∂–¥", "bi-cloud-rain"),
    81: ("–°–∏–ª–µ–Ω –ø—Ä–æ–ª–∏–≤–µ–Ω –¥—ä–∂–¥", "bi-cloud-rain"),
    82: ("–ú–Ω–æ–≥–æ —Å–∏–ª–µ–Ω –ø—Ä–æ–ª–∏–≤–µ–Ω –¥—ä–∂–¥", "bi-cloud-rain"),
    85: ("–õ–µ–∫–æ —Å–Ω–µ–≥–æ–≤–∞–ª–µ–∂", "bi-snow"),
    86: ("–°–∏–ª–µ–Ω —Å–Ω–µ–≥–æ–≤–∞–ª–µ–∂", "bi-snow"),
    95: ("–ë—É—Ä—è —Å –≥—Ä—ä–º–æ—Ç–µ–≤–∏—Ü–∏", "bi-cloud-lightning"),
    96: ("–ë—É—Ä—è —Å –≥—Ä—ä–º–æ—Ç–µ–≤–∏—Ü–∏ –∏ –≥—Ä–∞–¥—É—à–∫–∞", "bi-cloud-lightning"),
    99: ("–°–∏–ª–Ω–∞ –±—É—Ä—è —Å –≥—Ä–∞–¥—É—à–∫–∞", "bi-cloud-lightning")
}

def assign_weather(weather_code):
    return WEATHER_MAP.get(weather_code, ("–ù—è–º–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "bi-question-circle"))

def assign_wind(deg):
    directions = OrderedDict([
        (22.5, ("–°", "bi-arrow-up")),
        (67.5, ("–°–ò", "bi-arrow-up-right")),
        (112.5, ("–ò", "bi-arrow-right")),
        (157.5, ("–Æ–ò", "bi-arrow-down-right")),
        (202.5, ("–Æ", "bi-arrow-down")),
        (247.5, ("–Æ–ó", "bi-arrow-down-left")),
        (292.5, ("–ó", "bi-arrow-left")),
        (337.5, ("–°–ó", "bi-arrow-up-left")),
        (360, ("–°", "bi-arrow-up")),
    ])
    for threshold, (dir_text, icon) in directions.items():
        if deg < threshold:
            return dir_text, icon
    return "–°", "bi-arrow-up"