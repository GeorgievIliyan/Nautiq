{% load static %}
<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nautiq | Модераторско табло</title>
    <link rel="icon" type="image/x-icon" href="{% static 'images/logo/logo.svg' %}">
    <link rel="stylesheet" href="{% static 'dashboard_mod.css' %}">
</head>

<body class="mod-container">

    <h2 class="section-title blue">Плажове за одобрение</h2>

    {% for beach in pending %}
        <div class="mod-card green-border">
            <h3 class="card-title">{{ beach.name }}</h3>
            <p><strong>Описание:</strong> {{ beach.description }}</p>

            <div class="info-grid">
                <p><strong>Спасител:</strong> {{ beach.has_lifeguard|yesno:"Да,Не" }}</p>
                <p><strong>Паркинг:</strong> {{ beach.has_parking|yesno:"Да,Не" }}</p>
                <p><strong>Платен Паркинг:</strong> {{ beach.has_paid_parking|yesno:"Да,Не" }}</p>
                <p><strong>Тоалетни:</strong> {{ beach.has_toilets|yesno:"Да,Не" }}</p>
                <p><strong>Съблекални:</strong> {{ beach.has_changing_rooms|yesno:"Да,Не" }}</p>
                <p><strong>Платена зона:</strong> {{ beach.has_paid_zone|yesno:"Да,Не" }}</p>
                <p><strong>Заведения:</strong> {{ beach.has_beach_bar|yesno:"Да,Не" }}</p>
            </div>

            <div class="actions">
                <a href="{% url 'beach_approve' beach.id %}" class="btn green">Одобри</a>
                <a href="{% url 'beach_delete' beach.id %}" class="btn red">Премахни</a>
            </div>
        </div>
    {% empty %}
        <div class="alert blue">Няма плажове за одобрение...</div>
    {% endfor %}

    <h2 class="section-title red">Докладвани проблеми</h2>

    {% for report in reports %}
        <div class="mod-card red-border">
            <h3 class="card-title red">{{ report.title }}</h3>

            <div class="meta">
                <p>Плаж: <span class="highlight">{{ report.beach.name }}</span></p>
                <p>Потребител: <span class="highlight">{{ report.submitted_by.username }}</span></p>
                <p>Категория: <span class="highlight">{{ report.category }}</span></p>
            </div>

            <div class="beach-images">
                <h4>Снимки:</h4>
                {% for image_instance in report.beach.images.all %}
                    <img src="{{ image_instance.image.url }}" alt="Снимка на плаж {{ beach.name }}">
                {% empty %}
                    <p class="muted">Няма качени снимки.</p>
                {% endfor %}
            </div>

            <p><strong>Описание:</strong><br>
                {% if report.description %}
                    <span class="muted">{{ report.description }}</span>
                {% else %}
                    <span class="muted italic">Няма описание...</span>
                {% endif %}
            </p>

            <div class="actions">
                <a href="{% url 'report_resolve' report.id %}" class="btn green">Разрешено</a>
                <a href="#" class="btn yellow">Прегледай</a>
                <a href="{% url 'report_delete' report.id %}" class="btn red">Изтрии</a>
            </div>
        </div>
    {% empty %}
        <div class="alert blue mb-32">Няма докладвани проблеми...</div>
    {% endfor %}

    <a class="btn blue" href="{% url 'admin:index' %}">Назад към табло</a>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navItems = document.querySelectorAll('nav ul li');
            const currentPath = window.location.pathname;

            navItems.forEach(item => {
                item.classList.remove('active');

                const link = item.querySelector('a');
                if (link && link.getAttribute('href') === currentPath) {
                    item.classList.add('active');

                    const indicator = document.querySelector('.nav-indicator');
                    if (indicator && window.matchMedia('(min-width:601px)').matches) {
                        const rect = item.getBoundingClientRect();
                        const navRect = item.closest('nav').getBoundingClientRect();
                        indicator.style.left = (rect.left - navRect.left) + 'px';
                        indicator.style.top = (rect.top - navRect.top) + 'px';
                        indicator.style.width = rect.width + 'px';
                        indicator.style.height = rect.height + 'px';
                        indicator.style.display = 'block';
                    }
                }
            });
        });
    </script>

</body>
</html>