{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nautiq</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>
<body>
    <div class="container mx-auto mt-6">
        <h2 class="text-2xl font-semibold mb-4">ðŸŒŠ Sea Missions</h2>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for task in tasks %}
            <div class="
                border rounded-2xl p-5 shadow-md
                {% if task.id in accepted_ids %}
                border-blue-500 bg-blue-50
                {% elif task.id in completed_ids %}
                border-green-500 bg-green-50
                {% else %}
                border-gray-200
                {% endif %}
            ">
                <h3 class="text-xl font-bold mb-2">{{ task.title }}</h3>
                <p class="text-gray-700">{{ task.description }}</p>

                <div class="mt-2 flex justify-between items-center">
                    <span class="text-sm text-gray-500">
                        ðŸ’Ž {{ task.reward }} XP
                    </span>
                    <span class="text-xs uppercase tracking-wide px-2 py-1 rounded
                        {% if task.difficulty == 'easy' %}bg-green-100 text-green-700
                        {% elif task.difficulty == 'medium' %}bg-yellow-100 text-yellow-700
                        {% else %}bg-red-100 text-red-700{% endif %}
                    ">
                        {{ task.difficulty }}
                    </span>
                </div>

                {% if task.id in completed_ids %}
                    <p class="text-green-600 font-semibold mt-3">âœ… Completed!</p>

                {% elif task.id in accepted_ids %}
                    <form action="{% url 'complete_task' task.id %}" method="POST" enctype="multipart/form-data" class="mt-3">
                        {% csrf_token %}
                        <label class="text-sm font-medium">Upload proof:</label>
                        <input type="file" name="proof_image" accept="image/*" required class="block mt-1">
                        <button class="bg-blue-500 text-white px-4 py-2 mt-2 rounded-md">Submit Proof</button>
                    </form>

                {% else %}
                    <form action="{% url 'accept_task' task.id %}" method="POST" class="mt-3">
                        {% csrf_token %}
                        <button class="bg-green-500 text-white px-4 py-2 rounded-md">Accept Task</button>
                    </form>
                {% endif %}
            </div>
            {% empty %}
            <p>No tasks available at the moment.</p>
            {% endfor %}
        </div>
    </div>
</body>
</html>