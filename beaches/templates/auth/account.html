{% load static %}
<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nautiq | Акаунт</title>
  <!-- CSS -->
  <link rel="stylesheet" href="{% static 'alert.css' %}">
  <link rel="stylesheet" href="{% static 'nav.css' %}">
  <link rel="stylesheet" href="{% static 'account.css' %}?v={{ timestamp }}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
  <!--FAVICON-->
  <link rel="icon" type="image/x-icon" href="{% static 'images/logo/logo.svg' %}">

</head>
<body>
  {% include 'app/components/navbar.html' %}
  <div class="account-wrapper">
    <div class="account-quick-info">
      <div class="avatar-wrapper">
        <img src="{{ pfp }}" class="pfp">
        <div>
          <p class="username-main">{{ username }}</p>
          <p class="username-email">{{ email }}</p>
        </div>
      </div>
      <a href="{% url 'logout' %}" class="logout-btn">Излез <i class="bi bi-box-arrow-right"></i></a>
    </div>
    <div class="account-box">
      <h3>Информация за акаунта</h3>
      <div class="box-wrapper">
        <div>
          <p class="key">Потребителско име</p>
          <p class="value">{{ username }}</p>
        </div>
        <div>
          <p class="key">Емайл</p>
          <p class="value">{{ email }}</p>
        </div>
        <div>
          <p class="key">Прякор</p>
          <p class="value">{{ nickname }}</p>
        </div>
      </div>
    </div>
    <div class="account-box">
      <h3>Други</h3>
      <div class="box-wrapper">
        <div>
          <p class="key">Геогр. положение</p>
          <p class="value">{{ lat }}, {{ lng }}</p>
        </div>
        <div>
          <p class="key">Известия</p>
          <p class="value {% if notifs == 'Включени' %}text-green{% else %}text-red{% endif %}">
            {{ notifs }}
          </p>
        </div>
        <div>
          <p class="key">Тема</p>
          <p class="value" id="theme"></p>
        </div>
        <div>
          <p class="key">Език</p>
          <p class="value">{{ profile.language }}</p>
        </div>
      </div>
    </div>
    <div class="account-box">
      <h3>Статистики</h3>
      <div class="box-wrapper">
        <div>
          <p class="key">Изпълнени задачи</p>
          <p class="value">{{ compl }}</p>
        </div>
        <div>
          <p class="key">XP точки</p>
          <p class="value">{{ xp }}</p>
        </div>
        <div>
          <p class="key">Доклади</p>
          <p class="value">{{ logs }}</p>
        </div>
        <div>
          <p class="key">Ниво</p>
          <p class="value">{{ level }}</p>
        </div>
      </div>
    </div>
    <a href="{% url 'delete_account' %}" class="btn-red">Изтрии акаунт <i class="bi bi-trash3"></i></a>
  </div>

  <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('nav ul li').forEach(item => {
                item.classList.remove('active');
            });
            const account_nav_element = document.getElementById("nav-account");
            if (account_nav_element) {
                account_nav_element.classList.add("active");
                const indicator = document.querySelector('.nav-indicator');
                if (indicator && window.matchMedia('(min-width:601px)').matches) {
                    const rect = account_nav_element.getBoundingClientRect();
                    const navRect = account_nav_element.closest('nav').getBoundingClientRect();
                    indicator.style.left = (rect.left - navRect.left) + 'px';
                    indicator.style.top = (rect.top - navRect.top) + 'px';
                    indicator.style.width = rect.width + 'px';
                    indicator.style.height = rect.height + 'px';
                    indicator.style.display = 'block';
                }
            }
        });
  </script>

  <script src="{% static 'js/closeAlert.js' %}"></script>
  <script src="{% static 'js/popupAlert.js' %}"></script>

  <script>
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  let element = document.getElementById("theme")
  if (prefersDark){
    element.innerHTML = "Тъмна"
  }
  else{
    element.innerHTML = "Светла"
  }
  </script>

</body>
</html>